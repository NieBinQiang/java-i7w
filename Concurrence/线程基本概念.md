# 线程的基本概念
（摘自[https://blog.csdn.net/chenssy/article/details/47066127](https://blog.csdn.net/chenssy/article/details/47066127)）

共享、可变、线程安全性、线程同步、原子性、可见性、有序性。
## 共享和可变
- **共享**”就意味着变量可以**被多个线程同时访问**。系统中的**资源是有限的**，不同的线程对资源都是具有着**同等的使用权**。**有限、公平就意味着竞争**，竞争就有可能会引发线程问题。

- **可变**是指变量的值**在其生命周期内是可以发生改变**的。“**可变**”对应的是“**不可变**”。**不可变的对象一定是线程安全的，并且永远也不需要额外的同步**（因为一个不可变的对象只要构建正确，其外部**可见状态永远都不会发生改变**）。所以**可变意味着存在线程不安全的风险**。

## 线程安全性
- 线程安全**核心概念就是正确性**。所谓正确性就是某个类的**行为与其规范完全一致**，即其近似与“**所见即所知（we know it when we see it）**”。
- 当多个线程访问某个类时，不管运行时环境采用何种调度方式或者这些线程将如何交替执行，并且在主调代码中不需要任何额外的同步或者协同，这个类都能表现出**正确的行为**，那么就称这个类是线程安全的。

## 线程同步
- 线程同步，就是当线程发出一个功能调用时，在没有得到结果之前，该调用就不会返回，其他线程也不能调用该方法。
- 在说同步、异步的时候，特指那些**需要其他组件来配合**或者需要一定时间来完成的任务。
- 在多线程编程里面，一些较为敏感的数据时不允许被多个线程同时访问的，使用线程同步技术，**确保数据在任何时刻最多只有一个线程访问，保证数据的完整性**。
### 同步的机制
线程同步的机制主要有：**临界区**、**互斥量**、**事件**、**信号量**四种方式

1. **临界区**：通过对多线程的**串行化**来访问公共资源或一段代码，速度快，适合控制数据访问。在任意时刻只允许一个线程对共享资源进行访问，如果有多个线程试图访问公共资源，那么在有一个线程进入后，其他试图访问公共资源的线程将被挂起，并一直等到进入临界区的线程离开，临界区在被释放后，其他线程才可以抢占。（即同步代码块）

2. **互斥量**：采用**互斥对象机制**。（悲观锁） **只有拥有互斥对象的线程才有访问公共资源的权限**，因为互斥对象只有一个，所以能保证公共资源不会同时被多个线程访问。互斥不仅能实现同一应用程序的公共资源安全共享，还能实现不同应用程序的公共资源安全共享。

3. **信号量**：它允许多个线程在同一时刻访问同一资源，但是需要**限制在同一时刻访问此资源的最大线程数目**。（共享锁）

4. **事 件**： 通过**通知操作**的方式来保持线程的同步，还可以方便实现对多个线程的优先级比较的操作。（监听器）

## 原子性
原子性，即**不可分割性**。在编程中，如果某个操作不可分割，我们就称该操作具有**原子性**。非原子操作都存在线程安全问题，这个时候我们需要使用**同步机制**来保证这些操作变成原子操作，来确保线程安全。i++可以分割，不具备原子性，存在线程安全问题。

## 可见性
线程可见性是指**线程之间的可见性**，即**一个线程对状态的修改对另一个线程是可见的**，也就是一个线程修改的结果，另外一个线程立马就知道了。修饰volitile修饰的变量，具备可见性。

## 有序性   
有序性指的是数据不相关的变量在并发的情况下，实际执行的结果和单线程的执行结果是一样的，**不会因为重排序的问题导致结果不可预知**。  volatile, final, synchronized，显式锁都可以保证有序性。
